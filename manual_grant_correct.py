import pandas as pd
inflation_rates = {
    1985: 2.92, 1986: 2.87, 1987: 2.77, 1988: 2.66, 1989: 2.53,
    1990: 2.40, 1991: 2.31, 1992: 2.24, 1993: 2.17, 1994: 2.12,
    1995: 2.06, 1996: 2.00, 1997: 1.96, 1998: 1.93, 1999: 1.89,
    2000: 1.82, 2001: 1.78, 2002: 1.75, 2003: 1.71, 2004: 1.66,
    2005: 1.61, 2006: 1.56, 2007: 1.52, 2008: 1.46, 2009: 1.46,
    2010: 1.44, 2011: 1.40, 2012: 1.37, 2013: 1.35, 2014: 1.33,
    2015: 1.33, 2016: 1.31, 2017: 1.25, 2018: 1.25, 2019: 1.23,
    2020: 1.23, 2021: 1.16, 2022: 1.07, 2023: 1.03
}
df = pd.read_csv('processed_projects_labelled_inflation_adjusted.csv')


# Define your mappings in a dictionary
grant_values = {
    'RFA-AI-10-013': 1_550_000,
    'RFA-HD-12-189': 400_000,
    'RFA-HD-12-187': 324_000,
    'RFA-HL-18-023': 353_571,
    'RFA-LM-21-001': 750_000,
    'RFA-HD-16-018': 400_000,
    'RFA-OD-10-003': 133_333,
    'RFA-HL-08-017': 125_000,
    'RFA-ES-14-004': 93_344,
    'RFA-HD-23-010': 425_000,
    'RFA-DK-22-012': 96_000,
    'RFA-HD-10-015': 1_361_111,
    'RFA-HD-10-007': 400_000,
    'RFA-HD-12-208': 600_000,
    'RFA-RM-15-013': 325_000,
    'RFA-NS-19-040': 3_400_000,
    'RFA-HD-17-023': 1_400_000,
    'RFA-DA-10-015': 25_000,
    'RFA-DE-23-001': 250_000,
    'RFA-DK-11-019': 5_000_000,
    'RFA-AA-12-007': 2_000_000,
    'RFA-DK-10-009': 200_000,
    'RFA-HL-11-011': 831_600,
    'RFA-ES-19-010': 50_000,
    'RFA-NS-19-044': 249_000,
    'RFA-HS-10-011': 900_000,
    'RFA-DA-11-010': 40_000,
    'RFA-MD-07-001': 3_200_000,
    'RFA-HG-22-004': 333_333,
    'RFA-NS-13-004': 1_000_000,
    'RFA-AI-11-002': 19_000_000,
    'RFA-DC-20-002': 499_998,
    'RFA-CA-19-064': 400_000,
    'RFA-DK-18-024': 50_000,
    'RFA-HS-10-007': 850_000,
    'RFA-MD-09-008': 125_000,
    'RFA-FD-16-039': 10_000,
    'RFA-HL-23-006': 732_658,
    'RFA-HD-23-012': 920_000,
    'RFA-DE-11-003': 20_000,
    'RFA-NS-16-003': 100_000,
    'RFA-DK-08-006': 2_857_143,
    'RFA-HD-09-006': 7_125_000,
    'RFA-RR-10-002': 187_500,
    'RFA-LM-11-001': 1_120_000,
    'RFA-HS-11-001': 1_727_500,
    'RFA-AI-12-008': 5_233_333,
    'RFA-AG-12-001': 11_500_000,
    'RFA-DK-12-510': 18_000_000,
    'RFA-AI-12-011': 18_500_000,
    'RFA-OD-10-014': 235_000,
    'RFA-HL-09-005': 31_500_000,
    'RFA-AA-20-008': 375_000,
    'RFA-FD-21-008': 50_000_000,
    'RFA-DA-19-016': 30_000_000,
    'RFA-FD-21-028': 10_000_000,
    'RFA-FD-20-021': 3_000_000,
    'RFA-RM-18-006': 4_000_000,
    'RFA-AI-20-026': 11_500_000,
    'RFA-MH-20-340': 7_666_667,
    'RFA-FD-19-003': 10_000_000,
    'RFA-NS-19-012': 9_750_000,
    'RFA-OD-16-006': 9_400_000,
    'RFA-MD-21-007': 3_000_000,
    'RFA-AI-14-016': 16_500_000,
    'RFA-HL-16-009': 3_000_000,
    'RFA-AI-15-009': 11_500_000,
    'RFA-DK-17-508': 27_000_000,
    'RFA-DK-19-506': 6_750_000,
    'RFA-NS-20-013': 9_500_000,
    'RFA-FD-18-002': 10_000_000,
    'RFA-HS-10-008': 3_000_000,
    'RFA-GM-09-009': 2_000_000,
    'RFA-DK-07-012': 500_000,
    'RFA-HG-06-014': 2_166_667,
    'RFA-RR-07-006': 900_000,
    'RFA-MH-08-050': 150_000,
    'RFA-DA-09-001': 500_000,
    'RFA-MH-09-170': 250_000,
    'RFA-CA-08-026': 2_200_000,
    'RFA-RM-08-001': 4_250_000,
    'RFA-DK-11-501': 14_000_000,
    'RFA-DA-11-015': 125_000,
    'RFA-HD-15-029': 17_975_000,
    'RFA-DK-15-011': 10_100_000,
    'RFA-DK-15-506': 22_000_000,
    'RFA-RM-22-015': 5_000_000,
    'RFA-OD-22-021': 14_000_000,
    'RFA-AI-21-022': 3_333_333,
    'RFA-DK-12-503': 9_000_000,
    'RFA-ES-15-009': 8_000_000,
    'RFA-DK-14-507': 9_000_000,
    'RFA-DK-14-505': 4_000_000,
    'RFA-MD-13-002': 250_000,
    'RFA-DE-17-008': 150_007.5,
    'RFA-FD-23-010': 500_000,
    'RFA-HD-12-189': 400_000,
    'RFA-DK-12-003': 200_000,
    'RFA-DE-23-001': 250_000,
    'RFA-HG-22-004': 350_000,
    'RFA-DK-22-006': 750_000,
    'RFA-HD-23-010': 425_000,
    'RFA-DK-22-004': 135_000,
    'RFA-FD-23-010': 500_000,
    'RFA-DK-22-012': 96_000,
    'RFA-DE-17-008': 150_000,
    'RFA-HD-09-004': 750_000,
    'RFA-RM-06-006': 325_000,
    'RFA-RM-09-004': 5_000_000,
    'RFA-FD-15-006': 125_000,
    'RFA-AG-07-004': 92_593,
    'RFA-OD-07-001': 50_000,
    'RFA-HS-10-010': 500_000,
    'RFA-HD-12-209': 2_000_000,
    'RFA-HL-22-012': 154_000,
    'RFA-OD-10-009': 500_000,
    'RFA-AR-18-004': 500_000,
    'RFA-HD-20-013': 315_000,
    'RFA-OD-10-006': 500_000,
    'RFA-OD-10-006': 50_000,
    'RFA-NS-19-043': 50_000,
    'RFA-EY-10-001': 300_000,
    'RFA-DE-18-012': 20_000,
    'RFA-OD-16-013': 500_000,
    'RFA-TW-08-002': 250_000,
    'RFA-RM-10-001': 2_000_000,
    'RFA-HD-06-018': 35_000,
    'RFA-MH-09-171': 633_333,
    'RFA-OD-09-007': 300_000,
    'RFA-RR-09-009': 7_500_000,
    'RFA-HD-15-011': 315_000,
    'RFA-RM-08-002': 2_333_333,
    'RFA-OD-09-004': 1_000_000,
    'RFA-RM-16-012': 250_000,
    'RFA-HD-18-103': 920_000,
    'RFA-HD-17-021': 715_000,
    'RFA-MH-09-172': 210_000,
    'RFA-AR-16-002': 500_000,
    'RFA-AR-16-004': 500_000,
    'RFA-HS-10-013': 750_000,
    'RFA-MD-15-006': 100_000,
    'RFA-HD-19-008': 600_000,
    'RFA-HD-13-011': 400_000,
    'RFA-ES-20-007': 450_000,
    'RFA-RM-07-007': 4_750_000,
    'RFA-HS-08-001': 500_000,
    'RFA-CA-20-031': 250_000,
    'RFA-OD-10-012': 500_000,
    'RFA-HL-10-014': 250_000,
    'RFA-HD-14-019': 720_037,
    'RFA-TW-06-003': 250_000,
    'RFA-HD-18-011': 425_000,
    'RFA-OD-15-001': 350_000,
    'RFA-HG-20-047': 550_000,
    'RFA-RM-07-008': 100_000,
    'RFA-DK-10-012': 750_000,
    'RFA-OD-10-008': 450_000,
    'RFA-OD-10-010': 400_000,
    'RFA-OD-09-008': 1_000_000,
    'RFA-AR-16-003': 500_000,
    'RFA-RM-17-017': 700_000,
    'RFA-HS-10-012': 500_000,
    'RFA-OD-10-005': 1_000_000,
    'RFA-HD-21-017': 425_000,
    'RFA-HS-10-020': 4_000_000,
    'RFA-OD-10-007': 250_000,
    'RFA-ES-07-002': 250_000,
    'RFA-OD-10-002': 370_370,
    'RFA-HG-21-041': 500_000,
    'RFA-DK-21-032': 250_000,
    'RFA-HS-10-015': 2_770_000,
    'RFA-HS-10-014': 1_666_000
}
for foa_number, base_value in grant_values.items():
    df.loc[df['FOA_NUMBER'] == foa_number, 'GRANT_VALUE'] = base_value * df['FY'].map(inflation_rates)

df.to_csv('updated_projects_labelled_inflation_adjusted2.csv', index=False)
print(len(df))
too_small = df.loc[df['GRANT_VALUE'] < 40_000, 'FOA_NUMBER'].unique()
# only keep unique FOA_NUMBERS in too small
# print the first 5 FOA_NUMBERS in too_small
too_small = list(set(too_small))
# remove the FOA_NUMBERS in too_small that are in grant_values as keys
print("too small")
keys = grant_values.keys()
keys = list(set(keys))
keys = [x for x in too_small if x not in keys]
print(keys)
# print FOA_NUMBER in too_small and its GRANT_VALUE
#print(df.loc[df['FOA_NUMBER'].isin(keys), ['FOA_NUMBER', 'GRANT_VALUE']])
too_big = df.loc[df['GRANT_VALUE'] > 10_000_000, 'FOA_NUMBER'].unique()
# remove the FOA_NUMBERS in too_big that are in grant_values
print("too big")
print([x for x in too_big if x not in grant_values])